<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#222222">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>HKCRM2 - Cadastro e Histórico de Compras</title>
  <link rel="stylesheet" href="minimal.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <script src="produtos.js" defer></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: url('chucrute.jpg') no-repeat center center fixed;
      background-size: cover;
    }
    body.dark {
      background: #181818 url('chucrute.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #f1f1f1;
    }
    nav { background: #222; color: #fff; padding: 1rem; display: flex; gap: 1rem; }
    nav.dark, nav.dark a { background: #111 !important; color: #ffd700 !important; }
    nav a { color: #fff; text-decoration: none; cursor: pointer; }
    section { display: none; padding: 2rem; max-width: 600px; margin: auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px #0001; margin-top: 2rem; }
    section.active { display: block; }
    section.dark { background: rgba(30,30,30,0.97) !important; color: #f1f1f1; }
    h2 { margin-top: 0; }
    h2.dark { color: #ffd700 !important; }
    form { display: flex; flex-direction: column; gap: 1rem; }
    input, button, select { padding: 0.5rem; font-size: 1rem; }
    input.dark, select.dark, button.dark {
      background: #222;
      color: #ffd700;
      border: 1px solid #ffd700;
    }
    input.dark:focus, select.dark:focus {
      outline: 2px solid #ffd700;
      border-color: #ffd700;
    }
    button.dark {
      background: #ffd700;
      color: #222;
    }
    button.dark:hover {
      background: #ffe066;
      color: #222;
    }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
    table.dark, th.dark, td.dark {
      background: #222 !important;
      color: #ffd700 !important;
      border-color: #ffd700 !important;
    }
    .hidden { display: none; }
    .compra-card {
      background-color: #fff;
      transition: all 0.3s ease;
    }
    .compra-card.dark {
      background-color: #222;
      border-color: #ffd700 !important;
      color: #f1f1f1;
    }
    .compra-card table {
      margin-top: 1rem;
    }
    .compra-card table th {
      background-color: #f5f5f5;
      font-weight: bold;
    }
    .compra-card.dark table th {
      background-color: #333;
    }
    .compra-card table td, .compra-card table th {
      padding: 0.5rem;
      text-align: left;
      border: 1px solid #ddd;
    }
    .compra-card.dark table td, .compra-card.dark table th {
      border-color: #ffd700;
    }
  </style>
</head>
<body>
  <nav>
    <a data-target="login">Login</a>
    <a data-target="cadastro">Cadastro Cliente + Compra</a>
    <a data-target="historico">Histórico de Compras</a>
    <a data-target="cadastroProduto">Cadastro de Produto</a>
    <a data-target="buscaDoce">Buscar Produto</a>
    <button id="toggleTheme" style="margin-left:auto;">Modo Escuro</button>
  </nav>

  <section id="login" class="active">
    <h2>Login</h2>
    <form id="formLogin">
      <input type="email" id="loginEmail" placeholder="E-mail" required>
      <input type="password" id="loginSenha" placeholder="Senha" required>
      <button type="submit">Entrar</button>
    </form>
    <div id="loginMsg"></div>
  </section>

 <section id="cadastro">
  <h2>Cadastro de Cliente e Compra</h2>
  <form id="formCadastro">
    <!-- NOVO: tipo de cadastro -->
    <div class="form-group">
      <label for="tipoCadastro">O que deseja cadastrar?</label>
      <select id="tipoCadastro" required>
        <option value="">Selecione…</option>
        <option value="doce">Doce (Compra)</option>
        <option value="academia">Academia (Aluno)</option>
      </select>
    </div>

    <!-- Campos de cliente -->
    <div class="form-group">
      <label for="nomeCliente">Nome do Cliente</label>
      <input type="text" id="nomeCliente" required>
    </div>
    <div class="form-group">
      <label for="emailCliente">E-mail</label>
      <input type="email" id="emailCliente" required>
    </div>
    <!-- Outros campos (endereço, telefone) continuam aqui… -->

    <!-- NOVO: container de produtos/plano -->
    <div id="produtosContainer" class="form-group hidden">
      <label for="produtoSelect">
        Selecione o <span id="labelProduto">produto</span>
      </label>
      <select id="produtoSelect" required>
        <option value="">Carregando…</option>
      </select>
    </div>

    <button type="submit">Cadastrar</button>
  </form>

  <div id="cadastroMsg" class="mt-3"></div>
</section>

  <section id="cadastroProduto">
    <h2>Cadastro de Produtos</h2>
    <div class="tab-container">
      <div class="tab-buttons">
        <button class="tab-button" data-tab="doces">Doces</button>
        <button class="tab-button" data-tab="planos">Academia</button>
      </div>

      <div id="doces" class="tab-content">
        <form id="formCadastroDoce">
          <input type="text" id="nomeDoce" placeholder="Nome do Doce" required>
          <input type="text" id="saborDoce" placeholder="Sabor" required>
          <input type="number" id="precoDoce" placeholder="Preço (R$)" min="0" step="0.01" required>
          <input type="number" id="quantidadeDoce" placeholder="Quantidade" min="0" required>
          <button type="submit" id="btnCadastrarDoce">Cadastrar Doce</button>
        </form>
      </div>

      <div id="planos" class="tab-content">
        <form id="formCadastroPlano">
          <input type="text" id="nomePlano" placeholder="Nome do Plano" required>
          <select id="tipoPlano" required>
            <option value="">Selecione o Tipo</option>
            <option value="MENSAL">Mensal</option>
            <option value="TRIMESTRAL">Trimestral</option>
            <option value="SEMESTRAL">Semestral</option>
            <option value="ANUAL">Anual</option>
          </select>
          <input type="number" id="valorPlano" placeholder="Valor Mensal (R$)" min="0" step="0.01" required>
          <button type="submit" id="btnCadastrarPlano">Cadastrar Plano</button>
        </form>
      </div>
    </div>
  </section>

  <section id="buscaDoce">
    <h2>Buscar Produtos</h2>
    <div class="tab-container">
      <div class="tab-buttons">
        <button class="tab-button" data-tab="busca-doces">Doces</button>
        <button class="tab-button" data-tab="busca-planos">Academia</button>
      </div>

      <div id="busca-doces" class="tab-content">
        <form id="formBuscaDoce">
          <input type="text" id="buscaDoceNome" placeholder="Nome do Doce">
          <button type="submit" id="btnBuscarDoce">Buscar</button>
        </form>
        <div id="listaDoces" class="card-grid"></div>
      </div>

      <div id="busca-planos" class="tab-content">
        <div id="listaPlanos" class="card-grid"></div>
      </div>
    </div>
  </section>

  <section id="historico">
    <h2>Histórico de Compras</h2>
    <form id="formHistorico">
      <select id="clienteSelect" required><option value="">Selecione o cliente</option></select>
      <button type="submit">Buscar Compras</button>
    </form>
    <div id="historicoCompras"></div>
    <div id="historicoMsg"></div>
  </section>
  
  <section id="academia">
  <form id="formBuscaAcademia" class="search-form">
    <input type="text" id="buscaAcademiaNome" placeholder="Buscar serviço/plano..." />
    <button type="submit" id="btnBuscarAcademia">Buscar</button>
  </form>

  <div id="listaAcademia" class="product-list"></div>
</section>

  <section id="planos-content" class="content-section">
    <div class="section-header">
      <img src="images/logo-leao.png" alt="Oficina do Corpo" class="academia-logo">
      <h2>Planos de Academia</h2>
    </div>
    
    <div class="container">
      <div id="listaPlanos" class="planos-lista"></div>
      
      <div class="indicacao-card">
        <h3>Indique e Ganhe!</h3>
        <div class="beneficios">
          <p><i class="fas fa-check"></i> 15 dias grátis por indicação</p>
          <p><i class="fas fa-check"></i> Brindes exclusivos</p>
          <p><i class="fas fa-whatsapp"></i> Use: E-mail ou WhatsApp</p>
        </div>
      </div>
    </div>

    <div id="formCadastroPlano" class="form-section">
    </div>
  </section>

  <script>
    const themeManager = {
      isDark: false,
      elements: [],
      
      init() {
        this.isDark = localStorage.getItem('darkMode') === 'true';
        this.elements = document.querySelectorAll('body, nav, section, h2, input, select, button, table, th, td, .compra-card, .form-group');
        this.toggleButton = document.getElementById('toggleTheme');
        this.setupListeners();
        this.applyTheme();
      },

      setupListeners() {
        this.toggleButton.addEventListener('click', () => {
          this.isDark = !this.isDark;
          localStorage.setItem('darkMode', this.isDark);
          this.applyTheme();
        });
      },

      applyTheme() {
        this.elements.forEach(el => {
          el.classList.toggle('dark', this.isDark);
        });
        this.toggleButton.textContent = this.isDark ? 'Modo Claro' : 'Modo Escuro';
      }
    };

    const formManager = {
      init() {
        this.setupFormValidation();
        this.setupNavigation();
      },

      setupFormValidation() {
        document.querySelectorAll('form').forEach(form => {
          form.addEventListener('submit', this.handleSubmit.bind(this));
        });
      },

      setupNavigation() {
        document.querySelectorAll('nav a').forEach(link => {
          link.addEventListener('click', (e) => {
            const target = e.target.dataset.target;
            this.showSection(target);
          });
        });
      },

      showSection(id) {
        document.querySelectorAll('section').forEach(section => {
          section.classList.toggle('active', section.id === id);
        });
      },

      async handleSubmit(e) {
        e.preventDefault();
        const form = e.target;
        form.classList.add('loading');

        try {
          // Implementar lógica de envio do formulário aqui
          await new Promise(resolve => setTimeout(resolve, 1000)); // Simulação
          this.showFeedback(form, 'success', 'Operação realizada com sucesso!');
        } catch (error) {
          this.showFeedback(form, 'error', 'Erro ao processar operação. Tente novamente.');
        } finally {
          form.classList.remove('loading');
        }
      },

      showFeedback(form, type, message) {
        let feedback = form.querySelector('.form-feedback');
        if (!feedback) {
          feedback = document.createElement('div');
          feedback.className = 'form-feedback';
          form.appendChild(feedback);
        }

        feedback.textContent = message;
        feedback.classList.add('show', type);
        setTimeout(() => feedback.classList.remove('show'), 3000);
      }
    };

    // Adiciona inicialização
    document.addEventListener('DOMContentLoaded', () => {
      themeManager.init();
      formManager.init();
    });
  </script>
</body>
</html>
